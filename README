This repository contains Haskell bindings for the CCI library.

See COPYING for license information.

CCI API:
  https://parsci.assembla.com/code/cci-haskell/git/nodes/master/Network/CCI.hsc


== Building haddock documentation == 

cabal configure # avoid using "-f examples" or cabal haddock will fail.
cabal haddock


== Building cci for using the UDP sockets ==

# Install the 0.1a1 release of cci first. You'll have to request it at:
http://www.olcf.ornl.gov/center-projects/common-communication-interface/
# or via the mailing list:
http://lists.cci-forum.com/listinfo.cgi/cci-users-cci-forum.com

cabal configure -f examples

cabal build

# to generate documentation
cabal install # fixes error "cabal: Can't find deps for haddock" which would
              # otherwise happen when running "cabal haddock".
cabal haddock


== Running pingpong using UDP sockets ==

# Create a config file for using UDP sockets:
cat > cci.ini
[eth0]
driver = sock
# replace with your device ip address
ip = 192.168.0.1
# replace with your device mac address
mac = 00:e0:7d:ad:95:5e
default = 1


# Start the server
CCI_CONFIG=cci.ini dist/build/ex-pingpong/ex-pingpong -s
  Opened ip://192.168.0.1:46188
  ...

# Start the client using rma transfers upto 4 MB.
CCI_CONFIG=cci.ini dist/build/ex-pingpong/ex-pingpong -h ip://192.168.0.1:46188 -r 4194304

# Start the client using active messages
CCI_CONFIG=cci.ini dist/build/ex-pingpong/ex-pingpong -h ip://192.168.0.1:46188


== Building cci for using the verbs driver ==

This procedure builds cci statically due to some issues we have
when making ORNL CCI into a shared library.

# Get ORNL CCI 0.1a1 release.
# For parsci folks, this can be achieved by issuing:
git clone git@git.assembla.com:cci-ornl.git cci
git checkout v0.1a1

# For the rest of the world, you have to request a copy of the 0.1a1 release 
# to ORNL:
http://www.olcf.ornl.gov/center-projects/common-communication-interface/
# or via the mailing list:
http://lists.cci-forum.com/listinfo.cgi/cci-users-cci-forum.com
# and then rename the uncompressed folder:
tar -xzf cci-0.1a1.tar.gz
mv cci-0.1a1 cci

cabal configure -f "examples static-verbs"

cabal build


== Running pingpong ==

# Create a config file for using the verbs driver:
cat > cci.ini
[Infiniband]
driver=verbs
mss=1024
hca_id = mlx4_0

# Start the server
CCI_CONFIG=cci.ini dist/build/ex-pingpong/ex-pingpong -s
  Opened verbs://10.155.90.13:46188
  ...

# Start the client using rma transfers upto 4 MB.
CCI_CONFIG=cci.ini dist/build/ex-pingpong/ex-pingpong -h verbs://10.155.90.13:46188 -r 4194304

# Start the client using active messages
CCI_CONFIG=cci.ini dist/build/ex-pingpong/ex-pingpong -h verbs://10.155.90.13:46188

